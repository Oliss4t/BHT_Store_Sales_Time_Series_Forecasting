<!DOCTYPE html>
<html lang="en"><head>
<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/tabby.min.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.313">

  <meta name="author" content="John Doe">
  <title>Habits</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="report_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="report_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="report_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="report_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="report_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="report_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="report_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Habits</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
John Doe 
</div>
</div>
</div>

</section>
<section id="project-goal-and-outline" class="slide level2">
<h2>Project Goal and Outline</h2>
<p>The task at hand is to build a time-series forecasting model which will make predictions for 15 days after the last date in the train data. The dataset is based on a real-life retailer ‘Corporación Favorita’ from Ecuador and contains over 1,000,000 entries in the training data, featuring both categorical and continuous features. Additionally, there are other datasets which contain information which could impact sales, such as oil prices over this period, or holidays, which can be incorporated if desired to improve the model performance.</p>
<p>The primary train dataset is to be split into a new train and a validation set.</p>
<p>Our tactic for model selection is as follows: simply compare the below models with the aforementioned baseline models, predicting solely on the date and ignoring the family and store categories (i.e.&nbsp;we will group by date). The assumption here is that the model that performs best under this simplified process will also perform better when the family and store categories are taken into account.</p>
<p>The baseline methods are Exponential Smoothing, Double Exponential Smoothing, and a SARIMA model. These are then compared with two other models: Prophet, an algorithm by Facebook; and decision trees (regression tree and a Random Forest). For each of these, where relevant, the final parameters chosen were decided upon through a mixture of EDA, trial-and-error, and hyperparameter optimization.</p>
<p>This is a ‘top-down’ approach to this type of forecasting. We will rely on the distribution of the sales amongst the stores and families in the train dataset as our basis for how to divide up the sales that occur on a given day to the various stores and families. This will be how we make our final prediction for each id in the test set.</p>
<p>Our metric for selection, as per the instructions in the kaggle competition, is the Root Mean Squared Logarithmic Error (RMSLE). However, other metrics will be used in order to better make comparisons between the methods. This comparison of error will be done on the validation set from our earlier splitting of the initial train set. The best model will be decided based on which performs best under this comparison, and then the outlined ‘top-down’ approach will make the final predictions.</p>
</section>
<section id="data-and-information" class="slide level2">
<h2>Data and Information</h2>
<p>The dataset is from a kaggle “getting started” competition on time-series forecasting. The data originates from a large grocery retaile named “Corporación Favorita” from Ecuador. It contains information of 54 stores and 33 product families for the timeperiod of 2013-01-01 to 2017-08-31. The goal is to build a model that predicts the unit sales for each product family and store combination for the next 15 days after the last given timepoint. The given data consists of the following 6 files:</p>
<ul>
<li>Train: contains time series of the stores and the product families combination. The sales column gives the total sales for a product family at a particular store at a given date. Additionally we have the onpromotion column, which gives the total number of items in a product family that were being promoted at a store at a given date.</li>
<li>Test: same structure as train, except without the ‘sales’ value - this is what we have to predict with our model. A prediciton will be made for the 15 days after the end of the train set.</li>
<li>Store: gives some information about stores such as city, state, type, cluster.</li>
<li>Transactions: contains the number of total transactions for each store at a given date.</li>
<li>Holidays and Events: contains information of holidays during the timeperiod. The columns are date,type,locale,locale_name,description and transferred</li>
<li>Daily Oil Price: contains the oil price at a given date. This is important for predictions as Ecuador is an oil-dependent country and it’s economical health is highly vulnerable to shocks in oil prices and thereby also the sales of the grocery retailer.</li>
</ul>
<p>Additional notes for the challenge are:</p>
<ul>
<li>Wages in the public sector are paid every two weeks on the 15th and on the last day of the month. Supermarket sales could be affected by this.</li>
<li>A magnitude 7.8 earthquake struck Ecuador on April 16, 2016. People rallied in relief efforts donating water and other needed products which greatly affected supermarket sales for several weeks after the earthquake.</li>
</ul>
</section>
<section id="preprocessing" class="slide level2">
<h2>Preprocessing</h2>
<p>The preprocessing we done is mainly restricted to the train, test and the holidays and events data. The first thing we did is splitting the train data into a taining and validation set. The Training data will be used for training, the validation data will be used for model comparison. We then aggregated the train, validation and test set by date over all stores and product families to get the overall sales at a given date. We used that datastructure for all of the follwing models: Exponential Smoothing, Double Exponential Smoothing, SARIMA and the decision trees.</p>
<p>For the Prophet model we additonally used the holidays and events data as well as the on-promotion feature. The holidays and events data needed quite some preprocessing as some national holidays have been transferred and it needs to be accounted for that. Additonally there are regional and local events and holidays which make it even more complicated. As we havent used the regional feature we decided to only include the national events and holdays as they apply for the whole contry and therefore all stores.</p>
</section>
<section id="eda" class="slide level2">
<h2>EDA</h2>
<p>To start off we did a lot of exploratory data analysis. We will cover only the most interesting findings in the following. Additional plots are referenced in the text and can be found in the appendix.</p>
</section>
<section id="transactions" class="slide level2">
<h2>Transactions</h2>
<p>We found a stable pattern in the boxplot of the transactions (<a href="#/fig-transactions-boxplot">Figure&nbsp;1</a>). All months are similar except of the month December. In <a href="#/fig-timeline_by_store">Figure&nbsp;13</a> we the same behavior across every store. The store sales always increased at the end of the year.</p>
<div id="fig-transactions-boxplot" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/transactions_boxplot.png"></p>
<p></p><figcaption>Figure&nbsp;1: transactions_boxplot</figcaption><p></p>
</figure>
</div>
<p>Additional, the days of week seem to be very important for shopping. In <a href="#/fig-transactions-dayofweek">Figure&nbsp;2</a> we can identify a strong pattern. More transactions are made at the weekend. This pattern is consistent for all the years (2013-2017). Saturday is clearly the most important day for shopping.</p>
<div id="fig-transactions-dayofweek" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/transactions_dayofweek.png" style="height:80.0%"></p>
<p></p><figcaption>Figure&nbsp;2: transactions_dayofweek</figcaption><p></p>
</figure>
</div>
</section>
<section id="sales" class="slide level2">
<h2>Sales</h2>
<p>Our main objective is to predict store sales for each product family and at each store. For this reason, the sales column should be examined more closely. We started of with EDA, to get some general understanding of the data, followed up with investigating the autocorrelation, which can tell us how timeseries are correlated to their lags, and ended with STL decomposition.</p>
<p>We started EDA by plotting the correlation among stores for overall-sales at each timepoint. By examining <a href="#/fig-correlation-matrix">Figure&nbsp;14</a>, we can see that most of the stores are similar to each other. Some stores, however, such as 20, 21, 22, and 52, may be a little different.</p>
<p>Next we took a look at the daily total sales over all stores and products. We can see clear drops in <a href="#/fig-timeplot_overall_sales">Figure&nbsp;3</a>. By doing further analysis we found all the sales &lt; 100.000 which are listed in the following table. Interestingly, this is always the day after New Year’s Eve. This is perhaps unsurprising as many of the shops will be closed on New Year’s Day.</p>
<table>
<thead>
<tr class="header">
<th>date</th>
<th>sales</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013-01-01</td>
<td>2511.62</td>
</tr>
<tr class="even">
<td>2014-01-01</td>
<td>8602.07</td>
</tr>
<tr class="odd">
<td>2015-01-01</td>
<td>12773.62</td>
</tr>
<tr class="even">
<td>2016-01-01</td>
<td>16433.39</td>
</tr>
<tr class="odd">
<td>2017-01-01</td>
<td>12082.50</td>
</tr>
</tbody>
</table>
<div id="fig-timeplot_overall_sales" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/timeplot_overall_sales.png" style="width:80.0%"></p>
<p></p><figcaption>Figure&nbsp;3: Transactions DayofWeek</figcaption><p></p>
</figure>
</div>
<p>Next up we created a seasonal plot. A Seasonal plot is similar to a time plot except that the data are plotted against the individual “seasons” in which the data were observed. We created it over month (<a href="#/fig-seasonal-plot">Figure&nbsp;15</a>). We can see the same behaviour like in the transaction data. At the end of the year we have an increase in sales over all years, which is reflective of an increasing trend overall.</p>
<p>Additionally, we found that the feature onpromotion column is positive with the sales at a given day (<a href="#/fig-corr-on-promotion-sales">Figure&nbsp;16</a>). A bigger onpromotion value (mean per day over all products and stores) leads to a higher sales value.</p>
<h3 id="autocorrelation---how-are-timeseries-correlated-to-their-lags">Autocorrelation - How are timeseries correlated to their lags?</h3>
<p>Just as correlation measures the extent of a linear relationship between two variables, autocorrelation measures the linear relationship between lagged values of a time series. The lag features means shifting a time series forward one step or more than one. This autocorrelation for an observation and an observation at a prior time step is comprised of both the direct correlation and indirect correlations. These indirect correlations are a linear function of the correlation of the observation, with observations at intervening time steps. The partial autocorrelation function removes those indirect correlations.</p>
<p>To better understand the data we can use the autocorrelation function (ACF) and partial autocorrelation function (PACF) and identify the siginificant lag features, that we should include into the model. We see can clearly see (<a href="#/fig-tsplot">Figure&nbsp;4</a>) a 7 lag period in the ACF, which corresponds to a weekly periodicity. That was already expected, but it is good to have some statistical backing. The PACF shows a bigger partial autocorrelation for the 1,6 and 7 lags. Those lags could be interesting to include in the model.</p>
<p>Additionnally we also check the timeseries for stationarity. A time series is said to be stationary if its statistical properties do not change over time. In other words, it has constant mean and variance, and covariance is independent of time. We run the Dickey-Fuller statistical test to determine if a time series is stationary or not. The Dickey-Fuller-Test tests if a unit root is present. As the p value is at 0.0897 and bigger than 5%, we can not reject the nullhypothesis, and therefore have to assume that the process is not stationary.</p>
<div id="fig-tsplot" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/tsplot_30.png" style="height:100.0%"></p>
<p></p><figcaption>Figure&nbsp;4: Autocorrelation</figcaption><p></p>
</figure>
</div>
<h3 id="stl-decomposition">STL decomposition</h3>
<p>STL is a robust method for decomposing time series data. The acronym stands for “Seasonal and Trend decomposition using Loess”. It decomposes the data into a trend, season and the remaining part. The remainder should ideally be white noise, as a trend or pattern in the noise hints to an underlying feature which influences our data. We set the period parameter to 365 days for the following plot (<a href="#/fig-stl-decomposition">Figure&nbsp;5</a>). The trend component is quite clear. We can see an upwards trend for the sales. The seasonal component reveals a yearly pattern. We also got a clear weekly pattern by setting the period parameter to 7 days. The remainder component mostly shows white noise. Except of some outliers above and below. The outliers below are at the same time as our findings during EDA in section “Time Plots”. They occure all from the day after New Year’s Eve. Good to make the same findings across different methods.</p>
<div id="fig-stl-decomposition" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/stl_decomposition.png" style="height:100.0%"></p>
<p></p><figcaption>Figure&nbsp;5: STL Decomposition</figcaption><p></p>
</figure>
</div>
</section>
<section>
<section id="forecasting" class="title-slide slide level1 center">
<h1>Forecasting</h1>
<p>In the following chapter we applied the models introduced in the outline. We trained each model on the training data and evaluated it based on the evaluation set. For each forcasting method we give a detailed explanation how it works and share the optained metric results.</p>
</section>
<section id="baseline-model---exponential-smoothing" class="slide level2">
<h2>Baseline model - Exponential Smoothing</h2>
<p>We start of with a baseline model. The naive forecast would be using the last value or a moving average. What we choose as a basline is the simple univariate model exponential smoothing.</p>
<p>Exponential smoothing was proposed in the late 1950s and is a method of weighted averages of past observations, with the weights decaying exponentially as the observations get older. It is very simple, but therefore is not capable of modelling a seasonal or trend component. The formula is the following:</p>
<p>Forecast Equation: <span class="math inline">\(\hat{Y}_{t+1} = αy_t + α(1−α)y_{t−1} + α(1−α)^2y_{t−2} + ...\)</span></p>
<p>Therefore you only have to set the parameter <span class="math inline">\(α\)</span> and decide how many previous values you want to use for the prediction. We based out prediction only on the last value as a baseline and tried different numbers for alpha out. Our manual tries were worst then setting the optimization option = True.(<a href="#/fig-ESmoothing">Figure&nbsp;6</a>) Therefore, we choose the optimized version for calculating the validation error. We got the following metric scores:</p>
<table>
<thead>
<tr class="header">
<th>Model</th>
<th>RMSLE</th>
<th>MSE</th>
<th>MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exponential Smoothing</td>
<td>0.13876294591305696</td>
<td>1.316025e10</td>
<td>99941.04</td>
</tr>
</tbody>
</table>

<img data-src="./figs/SimpleExpSmoothing.png" class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;6: Exponential Smoothing</p></section>
<section id="double-exponential-smoothing" class="slide level2">
<h2>Double Exponential Smoothing</h2>
<p>The exponential smoothing method got extended by Holt to add a trend component. As we have a clear trend in out data, that is a good idea. The Double Exponential Smoothing involves a forecast equation and two smoothing equations (one for the level and one for the trend) and can be seen in the following:</p>
<p>Forecast Equation: <span class="math inline">\(\hat{y}_{t+h} = l_t + hb_t\)</span></p>
<p>Level Equation: <span class="math inline">\(l_t = αy_t + (1−α)(l_{t-1}+b_{t-1})\)</span></p>
<p>Trend Equation: <span class="math inline">\(b_t = β(l_t - l_{t-1}) + (1+β)b_{t-1}\)</span></p>
<p>We have now the new parameter beta and h to set. Alpha is again the smoothing for the level and beta now the smoothing for the trend. The parameter h is the number of steps you want to forecast ahead. As we basing out prediction only on the previous value, we set it to 1. Our manual tries were worst then setting the optimization option = True (<a href="#/fig-DESmoothing">Figure&nbsp;7</a>). Therefore, we choose again the optimized version for calculating the validation error. Of course alpha and beta do not have to be the same. We got the following metric scores for different alphas and betas:</p>
<table>
<colgroup>
<col style="width: 40%">
<col style="width: 27%">
<col style="width: 17%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>RMSLE</th>
<th>MSE</th>
<th>MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Double Exponential Smoothing</td>
<td>0.1393858049730297</td>
<td>1.327847e10</td>
<td>100600.89</td>
</tr>
</tbody>
</table>

<img data-src="./figs/HOLT.png" class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;7: Double Exponential Smoothing</p><p>There would also be a further addition called Holt-Winters method, whichs adds an additional seasonal component. For that there are two variations. There is the additive method, which is preferred when the seasonal variations are roughly constant through the series, while the multiplicative method is preferred when the seasonal variations are changing proportional to the level of the series. With our series we would have chosen the multiplicative version.</p>
</section>
<section id="sarima-model" class="slide level2">
<h2>SARIMA model</h2>
<p>The SARIMA model acronym stands for “Seasonal Auto-Regressive Integrated Moving Average”.</p>
<p>The “autoregressive” (AR) component of the model is represented by AR(p), with the p parameter determining the number of lagged series that we use. We found out in the ACF and PACF (chapter “Autocorrelation”), the first 7 lags, particular lag 1,6 and 7 are interesting for that. After the first 7 lags it repeats itself and the lags are not significant anymore. The “integrated” (I) is the difference order, which is the number of transformations (d) needed to make the data stationary. The parameter d represents the number of differences required to make the series stationary. As we have found out in chapter “Autocorrelation” that we have to assume non-stationary for our series, which comes in handy. The “moving average” (MA) is the moving average model with its parameter q as the number of included error lags. In an MA(1) model, our forecast is a constant term plus the previous error times a multiplier, added with the current error. The “Seasonal” (S) component extends the ARIMA model with an additional set of autoregressive and moving average components with the parameters S(P, D, Q, s). The parameters P and Q are the same as p and q, but now for the seasonal component. D is again the order of seasonal integration representing the number of differences required to make the series stationary. S is simply the season’s length. This was found to be 7, i.e.&nbsp;the seasonality in the model we selected is considered to be best represented by weekly seasonality. Combining all, we get the SARIMA(p, d, q)(P, D, Q, s) model.</p>
<p>In order to choose the other parameters for this SARIMA model, only a single number of differencings for both the seasonal and non-seasonal parts were needed to make the series stationary. Hence, both D and d are 1. Next, trial-and-error was used to select the order of the autoregressive (AR) and moving average (MA) terms. For the moving average, the fact that there the autocorrelation plots showed peaks at lag 1 made this a good starting point for our P and p terms. Our choice of Q and q equaling 1 for the Moving Average parts implies that only the error term from one time point prior is being taken into account when making our next prediction. For all of these Ps and Qs, perhaps higher values could have produced better model performance, but at the risk of model overfitting. Finally, the residuals of the model (shown in the top left of the diagram below) <a href="#/fig-SARIMA-Diagnostics">Figure&nbsp;17</a> seem to be distributed like noise, which implies that the model was a good fit for the data and that there are no major patterns left to be explained (with the exception of the four peaks, which are presumably representative of the stores being closed on New Year’s Day; this can be subsequently taken into account).</p>
<p>The performance on the vaildation data is given in the following table, graphically it can be seen in <a href="#/fig-sarima">Figure&nbsp;8</a>:</p>
<table>
<thead>
<tr class="header">
<th>Model</th>
<th>RMSLE</th>
<th>MSE</th>
<th>MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SARIMA</td>
<td>0.134025810826792</td>
<td>1.391188e10</td>
<td>83125.15</td>
</tr>
</tbody>
</table>

<img data-src="./figs/SARIMA.png" class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;8: SARIMA model</p></section>
<section id="prophet" class="slide level2">
<h2>Prophet</h2>
<p>The Prophet algorithm was introduced by <a href="https://peerj.com/preprints/3190.pdf">Sean J. Taylor and Ben Letham</a> from Facebook in 2017. It is designed to be easy and completely automatic. &gt; <a href="https://cran.r-project.org/web/packages/prophet/prophet.pdf">“It implements a procedure for forecasting time series data based on an additive model where non-linear trends are fit with yearly, weekly, and daily seasonality, plus holiday effects.”</a></p>
<p>Based on the additive model, we are also able to add regressors which coefficents can be interpreted as in the SARIMAX model.</p>
<p>We trained three different versions of the Prophet model. First we fit only on the training data. Next we added the preprocessed national holidays and events information as two different holiday types. For the third model we added the “on-promotion” feature as an additional regressor. The performance on the validation data of the three models is given in the following table:</p>
<table>
<colgroup>
<col style="width: 29%">
<col style="width: 26%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>RMSLE</th>
<th>MSE</th>
<th>MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Prophet Baseline</td>
<td>0.10672917726787304</td>
<td>0.866192e10</td>
<td>67894.59</td>
</tr>
<tr class="even">
<td>Prophet +Holidays</td>
<td>0.10471472504386517</td>
<td>0.840120e10</td>
<td>65890.04</td>
</tr>
<tr class="odd">
<td>Prophet +Holidays_OnPromotion</td>
<td>0.10471472504386517</td>
<td>0.840120e10</td>
<td>65890.04</td>
</tr>
</tbody>
</table>
<p>As we can see adding the holidays and events information to the baseline was decreasing every error metric. Adding the additional on-promotion feature on the other hand was not useful for the model. Therefore we stick with the “simpler” Prophet +Holidays model, which is graphically represented in <a href="#/fig-prophet-holidays">Figure&nbsp;9</a>. On the components plot (<a href="#/fig-Prophet-Components">Figure&nbsp;18</a>) of the final prophet model we can clearly see, that it picked up the trend component, the weekly and yearly component of the sales data.</p>

<img data-src="./figs/prophet_holidays.png" class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;9: Prophet &amp; Holidays</p></section>
<section id="regression-tree-and-random-forest" class="slide level2">
<h2>Regression Tree and Random Forest</h2>
<p>The code for this is visible in the ‘Decision Tree and Random Forest’ notebook.</p>
<p>A regression tree is a specific class of tree which will predict a numerical dependent variable based on a number of explanatory variables. This can be difficult to model through simpler models like linear regression; however, by partitioning the data into smaller regions, the interactions between the explanatory variables, potentially very complex, can become more manageable. In a tree model, this partitioning and sub-partitioning (i.e.&nbsp;recursively partitioning each partition) is done by the tree.</p>
<p>The splitting is done in a top-down, greedy manner, where the splitting starts at the top of the tree (i.e.&nbsp;all data-points belong to the same region), then this is split in 2, and this process is repeated for each split in the tree. It is greedy in the sense that it does not look ahead steps into the future; it simply predicts the best split for the split in question.</p>
<p>In preparing to train our models, we performed some feature engineering on the dataset such as the day of the week, the month, quarter and so on. This is to help the tree make better decisions as we have found things like the time of the year and the day of the week to have an important effect on the sales on a given day.</p>
<p>Something we were aware of in the creating of these models is that trees are not necessarily the best choice of model for time series where there is a clear trend, as there is in ours. As such, we train our models to predict the <em>differences</em> between sales values, rather than the sales values themselves, in the hope that this can in someway get our model to implicitly learn about the ongoing trend in our dataset.</p>
<p>The performance of the regression tree on our validation set is as follows:</p>
<table>
<thead>
<tr class="header">
<th>model</th>
<th>RMSLE</th>
<th>MSE</th>
<th>MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regression Tree cheated</td>
<td>0.128111</td>
<td>1.104584e+10</td>
<td>78066.83</td>
</tr>
<tr class="even">
<td>Regression Tree</td>
<td>0.307477</td>
<td>4.854608e+10</td>
<td>198903.99</td>
</tr>
</tbody>
</table>
<p>The very good performance of our first version of Regression Tree and Random Forest, led us to examine our code and we had, admittedly, made a mistake in our construction of both. Our model had been allowed ‘look’ at points in the past, at least implicitly, when it should not have. Hence these models were essentially cheating. In a second iteration of both models, we ammend these faults. After that both models were not performing outstandingly anymore.</p>
<p>A plot of its predictions over the actual data is shown below (<a href="#/fig-decision-tree">Figure&nbsp;10</a>). It is of course not as good as the cheated version in <a href="#/fig-decision-tree-cheated">Figure&nbsp;19</a>.</p>
<div id="fig-decision-tree" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/decision_tree_not_cheated.png"></p>
<p></p><figcaption>Figure&nbsp;10: Decision Tree</figcaption><p></p>
</figure>
</div>
<p>Our other candidate is the random forest. A random forest is a type of ensemble method, in this case similar to bagging for a regression tree; however, fewer parameters are chosen for each step that the tree is grown. This allows for more subtle effects to be found in a random forest than in a bagged regression tree, because in bagging all the dominant variables are contained within each bag, which will mean that variables that produce more nuanced effects on the prediction become crowded out.</p>
<p>This model is optimised using a simple Grid Search with Cross Validation for hyperparameter optimisation in order to choose the the best number of predictor variables to feature in the random forest. It produces the following prediction plot (<a href="#/fig-random-forest">Figure&nbsp;11</a>), again not as good as the cheated version in <a href="#/fig-random-forest-cheated">Figure&nbsp;20</a>.</p>
<div id="fig-random-forest" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/rf_FINAL_not_cheated.png"></p>
<p></p><figcaption>Figure&nbsp;11: Random Forest</figcaption><p></p>
</figure>
</div>
<p>The performance of the random forest is as follows:</p>
<table>
<thead>
<tr class="header">
<th>model</th>
<th>RMSLE</th>
<th>MSE</th>
<th>MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Random Forest cheated</td>
<td>0.083058</td>
<td>0.4648461e+10</td>
<td>46158.14</td>
</tr>
<tr class="even">
<td>Random Forest</td>
<td>0.173279</td>
<td>2.4810410e+10</td>
<td>144618.02</td>
</tr>
</tbody>
</table>
<p>The random forest performs a better than the regression tree. If one looks at the graph at early August, it seems to have captured that particular ‘n’-shaped pattern which we can see is a recurring type of shape in the data. The regression tree is however calculable hundreds of times quicker which may make it the more preferable choice of model as it allows us to iterate quickly where the random forest does not.</p>
</section></section>
<section>
<section id="model-comparisson" class="title-slide slide level1 center">
<h1>Model Comparisson</h1>
<table>
<colgroup>
<col style="width: 29%">
<col style="width: 26%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>RMSLE</th>
<th>MSE</th>
<th>MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exponential Smoothing</td>
<td>0.138762</td>
<td>1.316025e10</td>
<td>99941.04</td>
</tr>
<tr class="even">
<td>Double Exponential Smoothing</td>
<td>0.139385</td>
<td>1.327847e10</td>
<td>100600.89</td>
</tr>
<tr class="odd">
<td>SARIMA</td>
<td>0.134025</td>
<td>1.391188e10</td>
<td>83125.15</td>
</tr>
<tr class="even">
<td>Prophet +Holidays</td>
<td>0.104714</td>
<td>0.840120e10</td>
<td>65890.04</td>
</tr>
<tr class="odd">
<td>Regression Tree</td>
<td>0.307477</td>
<td>4.854608e+10</td>
<td>198903.99</td>
</tr>
<tr class="even">
<td>Random Forest</td>
<td>0.173279</td>
<td>2.481041e+10</td>
<td>144618.02</td>
</tr>
</tbody>
</table>
<p>In the first iteration, we made a mistake in the implementation of the decision tree and the random forest. This resulted in outstanding results and led us to examine our code and finally correction our mistake. In the second iteration both tree based models have performed worst. The clear winner across all metrics is the Prophet model. Hence we will use the Prophet model for the final prediction tasks.</p>
<p>Finally, it is worth briefly noting that the SARIMA model outperforms the two exponential smoothing models. This is not unsuprising as SARIMA models have long been a powerful performer in time-series tasks, and its strong performance is further vindication of the arguments put forward for the selection of the SARIMA parameters as discussed earlier on.</p>
</section>
<section id="distribution-for-top-down-approach" class="slide level2">
<h2>Distribution for Top-Down Approach</h2>
<p>There are 54 stores and 33 families which leads to 1782 possible combinations of the two being produced. The proportion of sales for each of these combinations has been found and this will be applied to the ‘bottom’ part of our approach to help us figure out how the sales on a given predicted day ought to be divided up. The distribution for each of the stores and familees can be inspected in the appendix (<a href="#/fig-distribution-stores">Figure&nbsp;21</a> &amp; <a href="#/fig-distribution-families">Figure&nbsp;22</a>)</p>
<p>There is a somewhat naive assumption made here in proportioning the data: the proportions for all these various family product combinations were done over the entire period of the train set. This of course assumes that the proportion of sales is relatively static over time. An argument could be made that the most recent few weeks may be more suitable; however, some simple analysis showed that there did not seem to be a large difference in the proportion of products sold over time. A more robust statistical test could have been done here in order to be more rigorous. Qualitatively, we argue that taking the entire time-series into account is more robust as any extreme events (such as the earthquake) will be dampened by the largely normal patters that predominate. Also, it is possible that in taking the proportions of only the most recent weeks, we could be basing our top-down model on an anomolous time period unbeknownst to ourselves.</p>
<p>Note, we found that out that some stores don’t sell some product families during EDA.This is also covered by the top-down approach.</p>
</section>
<section id="prediction-of-the-final-model" class="slide level2">
<h2>Prediction of the Final Model</h2>
<p>The code underlying how the final predictions were made is visible in the short notebook testing.ipynb. It produced 28512 predictions and these were submitted to Kaggle, giving us a user score of 0.65612, which placed our model in position 718 out of 892. A visual representation of the prediction of the unknown test data can be seen in <a href="#/fig-prophet-test-prediction">Figure&nbsp;12</a>.</p>

<img data-src="./figs/prohet_final_test_prediction.png" class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;12: Prophet Prediction on Test Data</p></section></section>
<section id="future-work-and-discussion" class="title-slide slide level1 center">
<h1>Future Work and Discussion</h1>
<p>In this study, we evaluated a predictive model for retail sales using various techniques. Our best performing model was the Prophet model, which produced 28512 predictions and gave us a user score of 0.65612 at Kaggle. This placed our model in position 718 out of 892. It is hard to say if this is a good score or not, as we would have to know how much effort the other teams had put in to get the results that they did. We hope at the very least that the predictions are somewhat sensible. It is also worth mentioning that this is the only submission that we entered; other teams both above and below us in the rankings had multiple attempts.</p>
<p>There are several areas where the model could be improved in future iterations. Firstly, as demonstrated in the exploratory data analysis, stores 20, 21, 22, and 52 have relatively low correlation with the other stores. Further examination could involve an error analysis of how the predictions for these specific stores behave in terms of the difference between predicted and actual test values. However, it is possible that the top-down approach, which created pairwise store-family pairs, captures these anomalies.</p>
<p>Additionally, we excluded oil data, which could be a significant omission given that the country’s economy is heavily dependent on the oil price. The reason for this is two-fold: Ecuador is a member of the Organization of the Petroleum Exporting Countries and its oil-production is state-owned, which impacts the strength of the economy, as well as for the government to provide services and social supports, which in turn will affect how much money people have to spend on things. Secondly, if oil prices increase, people will have to pay more for goods in general, not only for things like electricity but also for goods in shops, and the prices in shops will likely be higher owing to increased costs of business which will presumably negatively impact how much people can purchase.</p>
<p>Another omission in our model is the lack of transactions data. It is reasonable to expect that this would improve our predictions and would be included in future iterations of our model. Similarly, public wages were not included in the model. It would be easy to incorporate this as a sort of ‘holiday’ variable in the Prophet model. However, one could also argue that public sector workers are a small enough section of the population that it would not have a significant effect on sales.</p>
<p>Finally, the earthquake that occurred has not been explored in our EDA nor incorporated into our modeling. It is possible that the earthquake had a prolonged and large impact on the dataset. Given that earthquakes are relatively rare and unpredictable events, it would have been an option to interpolate more ‘regular’ values for this time period in this specific case. In our modeling, there is the implicit hope that the earthquake would be more akin to noise in the data given the rather prolonged time period in question.</p>
<p>In conclusion, while the model performed well in predicting retail sales, there are several areas where it could be improved in future iterations by incorporating omitted data and exploring the impact of rare events such as earthquakes.</p>
</section>

<section id="appendix" class="title-slide slide level1 center">
<h1>Appendix</h1>
<div id="fig-timeline_by_store" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/transactions_timeline_by_store.png"></p>
<p></p><figcaption>Figure&nbsp;13: transactions_timeline_by_store</figcaption><p></p>
</figure>
</div>
<div id="fig-correlation-matrix" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/correlations_among_stores.png"></p>
<p></p><figcaption>Figure&nbsp;14: correlation matrix among stores</figcaption><p></p>
</figure>
</div>
<div id="fig-seasonal-plot" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/seasonal_plot_for_sales_over_months.png"></p>
<p></p><figcaption>Figure&nbsp;15: Seasonal Plot for Sales over Months</figcaption><p></p>
</figure>
</div>
<div id="fig-corr-on-promotion-sales" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/correlation_between_onpromotion_and_sales.png"></p>
<p></p><figcaption>Figure&nbsp;16: Correlation between Onpromotion and Sales</figcaption><p></p>
</figure>
</div>
<div id="fig-SARIMA-Diagnostics" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/sarima_model.png"></p>
<p></p><figcaption>Figure&nbsp;17: SARIMA Diagnostics</figcaption><p></p>
</figure>
</div>
<div id="fig-Prophet-Components" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/prophet_components_plot.png"></p>
<p></p><figcaption>Figure&nbsp;18: Prophet Components</figcaption><p></p>
</figure>
</div>
<div id="fig-decision-tree-cheated" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/decision_tree.png"></p>
<p></p><figcaption>Figure&nbsp;19: Decision Tree Cheated</figcaption><p></p>
</figure>
</div>
<div id="fig-random-forest-cheated" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/rf_FINAL.png"></p>
<p></p><figcaption>Figure&nbsp;20: Random Forest Cheated</figcaption><p></p>
</figure>
</div>
<div id="fig-distribution-stores" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/store_sales.png"></p>
<p></p><figcaption>Figure&nbsp;21: Distribution of Stores</figcaption><p></p>
</figure>
</div>
<div id="fig-distribution-families" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./figs/family_sales.png"></p>
<p></p><figcaption>Figure&nbsp;22: Distribution of Families</figcaption><p></p>
</figure>
</div>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="report_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="report_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="report_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="report_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="report_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="report_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="report_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="report_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="report_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="report_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>